<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="SwiftWasm Blog"/><link rel="canonical" href="https://blog.swiftwasm.org/posts/update-03-october-2020"/><meta name="twitter:url" content="https://blog.swiftwasm.org/posts/update-03-october-2020"/><meta name="og:url" content="https://blog.swiftwasm.org/posts/update-03-october-2020"/><title>What's new in SwiftWasm #3 | SwiftWasm Blog</title><meta name="twitter:title" content="What's new in SwiftWasm #3 | SwiftWasm Blog"/><meta name="og:title" content="What's new in SwiftWasm #3 | SwiftWasm Blog"/><meta name="description" content="An update on what happened in the SwiftWasm ecosystem during the second half of October 2020."/><meta name="twitter:description" content="An update on what happened in the SwiftWasm ecosystem during the second half of October 2020."/><meta name="og:description" content="An update on what happened in the SwiftWasm ecosystem during the second half of October 2020."/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><link rel="stylesheet" href="/splash.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link href="https://fonts.googleapis.com/css2?family=Lora:wght@600&display=swap" rel="stylesheet"/><link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to SwiftWasm Blog"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">SwiftWasm Blog</a></div></header><div class="wrapper"><article><p><small>Published on <time datetime="2020-10-30T14:34:00Z">October 30, 2020.</time></small></p><div class="content"><h1>What's new in SwiftWasm #3</h1><h2>Examples and guides</h2><p><a href="https://github.com/hassan-shahbazi">@hassan-shahbazi</a> wrote <a href="https://medium.com/@h.shahbazi/the-power-of-swift-web-assembly-part-1-fdfa4e9134ee">a 3 part guide</a> about his experience when integrating SwiftWasm apps within Go apps through <a href="https://wasmer.io/">Wasmer</a>. He also published <a href="https://github.com/hassan-shahbazi/swiftwasm-go">example code accompanying the articles</a> on GitHub. It's a great introduction to SwiftWasm that doesn't assume much prior knowledge, and could be useful if you'd like to integrate binaries produced by SwiftWasm in a host application.</p><p><a href="https://github.com/johngarrett">@johngarrett</a> published an interactive <a href="https://garrepi.dev/swal">"Swift, Wasm, and Algorithms"</a> documentation page. It is a demo of the recently released <a href="https://github.com/apple/swift-algorithms">Swift Algorithms</a> package where you can tweak parameters for some of the functions and observe results directly in the browser. Not all of the functions are fully interactive now, but it's a great proof of concept for interactive documentation websites one could build with SwiftWasm. Its source code is <a href="https://github.com/johngarrett/swal-wasm">available on GitHub</a>.</p><h2>SwiftWasm documentation</h2><p>Two new sections were added to <a href="https://book.swiftwasm.org/">the SwiftWasm book</a> that clarify <a href="https://book.swiftwasm.org/getting-started/foundation.html">limitations of Foundation</a>, and <a href="https://book.swiftwasm.org/getting-started/testing.html">recommended ways to use XCTest</a> with the SwiftWasm SDK.</p><h2>Developer tools</h2><h3>WasmTransformer</h3><p><a href="https://github.com/kateinoigakukun">@kateinoigakukun</a> published <a href="https://github.com/swiftwasm/WasmTransformer">a pure Swift implementation of a transformer for Wasm binaries</a>. This resolves <a href="https://github.com/swiftwasm/JavaScriptKit/issues/97">the issue with <code>i64</code> to <code>BigInt</code> incompatibility in Safari</a>, as we can now <a href="https://github.com/swiftwasm/carton/pull/131">integrate an appropriate transformation</a> into our build pipeline in <code>carton</code>. The <code>WasmTransformer</code> library is still at an early stage, but it shows that Swift is suitable for low-level code just as well as C/C++ or Rust.</p><h3><code>carton</code></h3><p>In addition to the WasmTransfomer integration mentioned above, <code>carton test</code> now <a href="https://github.com/swiftwasm/carton/pull/130">passes the <code>--enable-test-discovery</code> flag</a> to <code>swift test</code> by default, which means that you no longer need to maintain <code>LinuxMain.swift</code> and <code>XCTestManifests.swift</code> files in your test suites.</p><p>A <code>Dockerfile</code> <a href="https://github.com/swiftwasm/carton/pull/136">was added to the <code>carton</code> repository</a>, and you can now run <code>carton</code> in a Docker container, which also has the toolchain and other dependencies preinstalled. You can pull the Docker image with a simple command:</p><pre><code>docker pull ghcr.<span class="splash-property">io</span>/swiftwasm/carton:latest
</code></pre><p>Additionally, <code>carton</code> gained <a href="https://github.com/swiftwasm/carton/pull/134">support for Ubuntu 20.04</a>, and now also has a CI job to test compatibility with it during development. Similarly, <a href="https://github.com/swiftwasm/carton/pull/132">a CI job for macOS Big Sur on Intel platforms</a> was added as soon as GitHub Actions started providing appropriate CI images.</p><p>After these changes were merged <a href="https://github.com/swiftwasm/carton/releases/tag/0.7.0"><code>carton</code> 0.7 was released</a> and is now available via Homebrew on macOS.</p><p>After the release, <a href="https://github.com/carson-katri">@carson-katri</a> merged a PR that greatly improves command-line experience with <code>carton test</code>. It builds on his previous work on <code>carton dev</code> with compiler diagnostics parsing and error highlighting. With this new change XCTest output is also parsed, reformatted, and highlighted in a nice summary view.</p><br /><img src="/images/update-03-carton-test-summary.png" alt="Pretty-printed test summary in &#96;carton&#96;" width="100%"/><br /><br /><img src="/images/update-03-carton-test-errors.png" alt="Pretty-printed test errors in &#96;carton&#96;" width="100%"/><br /><br /><h3>GitHub Actions</h3><p>Thanks to the fact that <code>carton</code> is now available in a Docker image, it can now be used in our <a href="https://github.com/swiftwasm/swiftwasm-action"><code>swiftwasm-action</code></a>, which previously only contained the plain SwiftWasm toolchain without any additional tools. This action now invokes <code>carton test</code> by default on a given repository during a GitHub Actions run, but you can customize it and call any other command. For example, you could run <code>carton bundle</code> with <code>swiftwasm-action</code>, and then use the <a href="https://github.com/peaceiris/actions-gh-pages"><code>peaceiris/actions-gh-pages</code></a> step to deploy the resulting bundle to <a href="https://pages.github.com/">GitHub Pages</a>.</p><h2>Libraries</h2><h2>JavaScriptKit</h2><p><a href="https://github.com/swiftwasm/JavaScriptKit/releases/tag/0.8.0">JavaScriptKit 0.8.0</a> has been released. As mentioned in our previous issue, it introduces a few enhancements and deprecations, and is a recommended upgrade for all users.</p><h3>Tokamak</h3><p><a href="https://github.com/Cosmo">@Cosmo</a> pointed out that SwiftUI apps should change almost the whole palette when switching between color schemes. As he discovered when working on his <a href="https://github.com/Cosmo/OpenSwiftUI/">OpenSwiftUI</a> and <a href="https://github.com/Cosmo/SwiftUIEmbedded">SwiftUIEmbedded</a> projects, the implementation of the <code>Color</code> type is much more subtle than we originally anticipated. This was resolved by <a href="https://github.com/carson-katri">@carson-katri</a> in <a href="https://github.com/TokamakUI/Tokamak/issues/291">#291</a> and is now available in the <code>main</code> branch. The plan is to merge a few more changes and bugfixes, and to tag a new release of Tokamak soon after that.</p><h2>Upstream PRs</h2><h3>Swift Driver</h3><p><a href="https://github.com/owenv">@owenv</a> merged <a href="https://github.com/apple/swift-driver/pull/315">a PR to the Swift Driver project</a> implementing WebAssembly toolchain support. This mirrors our existing <a href="https://github.com/swiftwasm/swift/blob/swiftwasm/lib/Driver/WebAssemblyToolChains.cpp">C++ implementation in the legacy driver</a>, and it's great that the new parts of the Swift compiler rewritten in Swift are going to support WebAssembly too. While Swift Driver isn't enabled in any toolchain by default, we're definitely going to enable it at some point in the future as soon as it seems to be stable enough for us.</p><h3>SwiftPM and Swift Tools Support Core</h3><p><a href="https://github.com/kateinoigakukun">@kateinoigakukun</a> submitted <a href="https://github.com/apple/swift-package-manager/pull/3001">a PR to SwiftPM</a> that propagates the <code>-static-stdlib</code> flag correctly to the compiler driver. After it was merged, we were able <a href="https://github.com/swiftwasm/carton/pull/141">to remove a bit of code</a> that generated SwiftPM destination files to ensure correct linking, and this is no longer needed thanks to the upstream changes.</p><p><a href="https://github.com/sponsors/MaxDesiatov">@MaxDesiatov</a> merged <a href="https://github.com/apple/swift-tools-support-core/pull/153">a PR to Swift TSC</a> that adds <code>.wasm</code> file extension to WebAssembly binaries produced by SwiftPM. This extension was previously missing, which didn't make it obvious enough that these binaries can't be run without passing them to an appropriate WebAssembly host.</p><h2>Toolchain/SDK work</h2><p>In preparation for the 5.3.0 release of SwiftWasm, our macOS archives are <a href="https://github.com/swiftwasm/swift/pull/2029">now distributed as signed <code>.pkg</code> installers</a>. Also need to mention that the toolchain archive is now available for Ubuntu 20.04, and all archive files now have consistent naming that includes the full OS name and CPU architecture. This will make it much easier for us to distribute ARM64 builds and builds for other Linux distributions in the future.</p><p><a href="https://github.com/swiftwasm/swift/pull/2125">Another change</a> to be included in 5.3 snapshots would add <code>.wasm</code> file extension to binaries reflecting aforementioned upstream PRs.</p><p>Additionally, we found that it's currently not possible to build C++ code that includes certain headers with SwiftWasm 5.3 snapshots. As some Swift libraries do have C++ targets as their dependencies, <a href="https://github.com/swiftwasm/swift/pull/2127">it would be great if this is fixed</a> before SwiftWasm 5.3.0 is tagged.</p><p>We'll be using latest 5.3 snapshots in our apps and libraries for some time, and will tag 5.3.0 when we have enough confidence there are no major issues.</p><p>The <code>wasm-DEVELOPMENT-SNAPSHOT</code> archives will continue to be tagged on a regular basis to serve as a preview of the next version of SwiftWasm, but are not recommended for general use.</p><h2>Contributions</h2><p>A lot of the progress wouldn't be possible without payments from our GitHub Sponsors. Their contribution is deeply appreciated and allows us to spend more time on SwiftWasm projects. You can see the list of sponsors and make your contribution on the sponsorship pages of <a href="https://github.com/sponsors/carson-katri">Carson Katri</a>, <a href="https://github.com/sponsors/kateinoigakukun">Yuta Saito</a> and <a href="https://github.com/sponsors/MaxDesiatov">Max Desiatov</a>.</p><p>Thanks for reading! 👋</p></div></article></div><footer><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p><p><a href="/feed.rss">RSS feed</a></p></footer></body></html>